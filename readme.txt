# פרומפט מפורט להקמת מערכת השוואת שעות עבודה - פיל vs מתן

## 🎯 מטרת המערכת
ליצור מערכת ווב מבוססת HTML/CSS/JavaScript המשווה שעות עבודה חודשיות בין שני עובדים: "פיל" (המעסיק) ו"מתן" (העובד). המערכת תכלול טעינת נתונים מקובצי Excel, השוואה אוטומטית, סימון שורות מאושרות, וייצוא לדוחות PDF ו-Excel.

## 📋 תכונות עיקריות

### 1. ממשק משתמש (UI/UX)
- **עיצוב מודרני וברור** בעברית עם תמיכה מלאה ב-RTL
- **תגובה רספונסיבית** להתאמה לכל מכשיר (מחשב, טאבלט, מובייל)
- **קריאת עברית תקינה** בכל רכיבי המערכת
- **סידור לוגי** של הקומפוננטות:
  - בחירת חודש ושנה
  - כפתורי פעולה מהירה
  - טעינת קבצי Excel
  - טבלת השוואה ראשית
  - סיכומים והפרשים

### 2. בחירת חודש ושנה
- בחירת חודש מתוך רשימה (ינואר-דצמבר)
- בחירת שנה עם הגבלת טווח (2020-2030)
- יצירת טבלת חודש עם כל הימים
- שמירה וטעינה מ-Local Storage

### 3. טבלת השוואה ראשית
**כותרות עמודות:**
1. שם העובד
2. תאריך (יום/חודש/שנה)
3. יום בשבוע (ראשון-שבת)
4. כניסה פיל (שעון)
5. יציאה פיל (שעון)
6. שעות פיל מדווחות (מספר)
7. שעות פיל מחושבות (חישוב אוטומטי)
8. אירוע (בחירה מרשימה: חיסור, חג, קייטנה, חופש, אחר)
9. איחור (חישוב אוטומטי)
10. כניסה מתן (שעון)
11. יציאה מתן (שעון)
12. סה"כ שעות מתן (חישוב אוטומטי)
13. הערות (שדה טקסט רחב)
14. מאושר (תיבת סימון עם ✓/✗)
15. סטטוס (חישוב אוטומטי)

### 4. טעינת קבצי Excel
- קבלת קבצי Excel (.xlsx, .xls) מהמעסיק (פיל)
- זיהוי אוטומטי של עמודות: תאריך, שם, כניסה, יציאה, שעות
- חילוץ נתונים אוטומטי והזנתם לטבלה
- מערכת דיבג מפורטת לזיהוי בעיות
- תמיכה במבנים שונים של קבצי Excel

### 5. פיצ'רים אוטומטיים
- **מילוי אוטומטי של שעות מתן** לפי ימי השבוע:
  - יום א': 12:45-16:30
  - ימים ב-ה': 13:30-16:30
- **חישוב שעות אוטומטי** מהשעונים
- **חישוב איחור** בין כניסת פיל לכניסת מתן
- **זיהוי בעיות**: נתונים חסרים, חוסר התאמה
- **עדכון סטטוס אוטומטי** בכל שינוי

### 6. מערכת צבעים מפושטת
- **ירוק בולט (#d4f7d4)**: שורות מאושרות או תואמות
- **צהוב חזק (#fff9c4)**: נתונים חסרים או לא חופפים
- **אדום בהיר (#ffe6e6)**: ימי שישי ושבת
- **כתום (#fff0e6)**: חופש, חג, אירועים אחרים
- **כחול (#e6f7ff)**: קייטנה
- **מעבר חלק** בין צבעים בהתאם לסטטוס

### 7. עמודת "מאושר"
- **תיבת סימון עם סמלים**: ✓ ירוק (מאושר), ✗ אדום (לא מאושר)
- **שינוי צבע שורה**: ירוק בולט לשורה מאושרת
- **עדכון סטטוס אוטומטי**: השורה מסומנת כ"מאושר"
- **השפעה על הדוח**: שורות מאושרות לא מופיעות בדוח לפיל

### 8. חישובים אוטומטיים
- **שעות פיל מחושבות**: חישוב אוטומטי משעוני כניסה/יציאה
- **שעות מתן**: חישוב אוטומטי משעונים
- **איחור**: חישוב אוטומטי בהפרש דקות
- **סיכומים**: סך שעות פיל, מתן, והפרשים
- **סטטוס שורה**: זיהוי אוטומטי של מצב השורה

### 9. דוח מיוחד לפיל
- **טבלת הפרשים בלבד**: רק שורות עם חוסר התאמה ולא מאושרות
- **סיכום הפרשים**: חישוב הפרשים בין שעות פיל למתן
- **סימון שורות מאושרות**: שורות מאושרות לא מופיעות בדוח
- **הודעת הצלחה**: הודעה כאשר אין הפרשים

### 10. ייצוא דוחות
**ייצוא ל-Excel:**
- עיצוב מקצועי עם כותרות בעברית
- שמירת כל הנתונים
- חישובי סיכומים והפרשים
- שורת סיכום חודשית

**ייצוא ל-PDF:**
- תמיכה מלאה בעברית (כיוון RTL)
- שתי דפים:
  1. דף ראשי: כל הטבלה עם סיכום
  2. דף נפרד: מכתב לפיל עם טבלת ההפרשים בלבד
- עיצוב נקי וברור
- התאמה לרוחב הדף

### 11. תכונות נוספות
- **שמירה אוטומטית**: שמירת כל הנתונים ב-Local Storage
- **טעינת נתונים**: טעינת נתונים קיימים בעת פתיחה
- **ניקוי נתונים**: איפוס המערכת עם אישור
- **הודעות מערכת**: התראות הצלחה/שגיאה/אזהרה
- **דיבג מפורט**: מערכת לזיהוי בעיות בעיבוד קבצים

## 🔧 דרישות טכניות

### 1. ספריות חיצוניות
- **xlsx.full.min.js**: לעיבוד קבצי Excel
- **jspdf.umd.min.js**: ליצירת קבצי PDF
- **jspdf-autotable.min.js**: ליצירת טבלאות ב-PDF

### 2. תמיכה בדפדפנים
- Chrome (גרסה 60+)
- Firefox (גרסה 55+)
- Safari (גרסה 11+)
- Edge (גרסה 79+)

### 3. פונקציונליות JavaScript
- קריאה/כתיבה ל-Local Storage
- עיבוד קבצי Excel
- יצירת קבצי PDF
- חישובים מתמטיים מדויקים
- ניהול אירועים דינאמיים

### 4. עיצוב CSS
- מערכת צבעים מוגדרת ב-:root
- תמיכה מלאה ב-RTL
- תגובה רספונסיבית עם media queries
- טבלאות עם גלילה אופקית במסכים קטנים
- אנימציות מעבר חלקות

## 📝 תרחישי שימוש

### תרחיש 1: העלאת קובץ Excel
1. משתמש בוחר חודש ושנה
2. מעלה קובץ Excel עם נתוני פיל
3. המערכת מעבדת את הקובץ וממלאת את הטבלה
4. המשתמש ממלא את שעות מתן (ידנית או אוטומטית)
5. המערכת משווה ומחשבת הבדלים

### תרחיש 2: אישור שורות
1. המשתמש סורק את הטבלה
2. מסמן שורות תואמות כמאושרות (✓)
3. השורות הופכות לירוקות ומוסרות מהדוח לפיל
4. שורות לא תואמות נשארות בצהוב/אדום

### תרחיש 3: יצירת דוחות
1. המשתמש לוחץ על "ייצוא ל-PDF"
2. המערכת יוצרת קובץ PDF עם:
   - עמוד 1: טבלה מלאה
   - עמוד 2: דוח הפרשים לפיל
3. המשתמש לוחץ על "ייצוא ל-Excel"
4. המערכת יוצרת קובץ Excel מעוצב

## 🐛 פתרון בעיות ספציפיות

### 1. קריאת שעות פיל מהקובץ
- המערכת תחפש עמודות בשמות שונים (שעות, hours, total, work, time)
- אם שעות לא נמצאות, תחשב אוטומטית משעוני כניסה/יציאה
- תיעוד מלא של תהליך העיבוד בחלון דיבג

### 2. עמודת הערות קטנה
- הגדלת רוחב עמודת הערות ל-120px לפחות
- תמיכה בטקסט ארוך עם גלילה אופקית

### 3. עמודת מאושר לא עובדת
- הוספת סמלי ✓/✗ בולטים
- שינוי צבע שורה אוטומטי
- עדכון סטטוס מיידי

### 4. ייצוא PDF בעברית
- הגדרת שפה לעברית (he-IL)
- כיוון טקסט מימין לשמאל
- עיצוב טבלאות מותאם לעברית
- פיצול לדפים עם כותרות מתאימות

## 🎨 הנחיות עיצוב מפורטות

### פלטת צבעים:
```css
:root {
    --primary: #2c3e50;      /* כחול כהה - כותרות */
    --secondary: #3498db;    /* כחול - כפתורים רגילים */
    --success: #27ae60;      /* ירוק - הצלחה, מאושר */
    --warning: #f39c12;      /* כתום - אזהרה */
    --danger: #e74c3c;       /* אדום - שגיאה */
    --light: #ecf0f1;        /* אפור בהיר - רקעים */
    --dark: #2c3e50;         /* כחול כהה - טקסט */
    --weekend: #ffe6e6;      /* אדום בהיר - סופ"ש */
    --event: #fff0e6;        /* כתום - אירועים */
    --camp: #e6f7ff;         /* כחול בהיר - קייטנה */
    --approved: #d4f7d4;     /* ירוק בהיר - מאושר */
    --missing-data: #fff9c4; /* צהוב חזק - נתונים חסרים */
}
```

### טיפוגרפיה:
- גופן ברירת מחדל: מערכת (Apple, BlinkMacSystemFont, 'Segoe UI', Roboto)
- גודל טקסט בסיסי: 1rem (16px)
- כותרות: 1.2rem-1.5rem
- טקסט קטן: 0.8rem-0.9rem

### אנימציות:
- מעבר צבעים חלק: transition 0.3s
- הודעות נעלמות אוטומטית אחרי 5 שניות
- טבלאות עם גלילה חלקה

## 📊 לוגיקת חישוב

### חישוב שעות:
```javascript
שעות = (יציאה - כניסה) / (1000 * 60 * 60)
אם שעות < 0: שעות += 24  // עבור עבודה לאחר חצות
שעות = עיגול(שעות * 4) / 4  // עיגול לרבע שעה
```

### חישוב איחור:
```javascript
אם כניסת_מתן > כניסת_פיל:
    איחור_דקות = (כניסת_מתן - כניסת_פיל) / (1000 * 60)
    תצוגה: שעה:דקות
```

### סטטוס שורה:
1. **תואם**: שעות פיל = שעות מתן = שעות מחושבות
2. **הפרש**: שעות פיל ≠ שעות מתן
3. **חסר מתן**: יש שעות פיל, אין שעות מתן
4. **חסר פיל**: אין שעות פיל, יש שעות מתן
5. **אין נתונים**: אין נתונים כלל

## 🚀 פרומפט הרצה

"צור מערכת ווב שלמה להשוואת שעות עבודה חודשיות בין פיל (מעסיק) למתן (עובד). המערכת חייבת לכלול את כל הפיצ'רים הבאים:

1. ממשק עברי מלא עם תמיכה ב-RTL ועיצוב מודרני
2. בחירת חודש ושנה עם יצירת טבלת ימים אוטומטית
3. טעינת קבצי Excel של פיל עם זיהוי עמודות אוטומטי
4. טבלת השוואה עם 15 עמודות (כולל חישובים אוטומטיים)
5. מערכת צבעים מפושטת עם 5 צבעים עיקריים
6. עמודת 'מאושר' עם תיבות סימון וסמלי ✓/✗ בולטים
7. מילוי אוטומטי של שעות מתן לפי ימי השבוע
8. דוח מיוחד לפיל עם שורות לא מאושרות בלבד
9. ייצוא ל-PDF בשני דפים עם תמיכה מלאה בעברית
10. ייצוא ל-Excel מעוצב
11. שמירה אוטומטית ב-Local Storage
12. מערכת התראות והודעות
13. חלון דיבג מפורט לטעינת קבצים

המערכת חייבת להיות:
- רספונסיבית ומתאימה לכל מסך
- עם חישובים מדויקים של שעות ואיחורים
- עם ממשק משתמש אינטואיטיבי ופשוט לשימוש
- עם קוד נקי ומעודכן הכולל את כל התיקונים מהשיחה

העבר את הקוד המלא בקובץ HTML יחיד הכולל:
- את כל ה-HTML עם מבנה לוגי
- את כל ה-CSS עם מערכת צבעים מפושטת
- את כל ה-JavaScript עם פונקציות מאורגנות
- שימוש בספריות xlsx, jspdf, ו-jspdf-autotable
- פתרון לכל הבעיות שהוזכרו בשיחה

הקוד חייב להיות מוכן להרצה מיידית - העתקה, הדבקה ופתיחה בדפדפן."